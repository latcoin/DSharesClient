!function(a){a.fn.shortPass="Short",a.fn.badPass="Weak",a.fn.goodPass="Good",a.fn.strongPass="Strong",a.fn.samePassword="Username and Password identical.",a.fn.resultStyle="",a.fn.passEqual=function(b){var c=a(this),d=a(b);c.add(d).on("input",function(){c.next(".testresult").remove(),c.val()&&(c.val()!=d.val()?c.after(a("<span>").addClass("badPass testresult").html("<span>Passwords don't match.</span>")):c.after(a("<span>").addClass("strongPass testresult").html("<span>Passwords match.</span>")))})},a.fn.validateWithRegex=function(b,c,d){a(this).unbind().on("input",function(){a(this).next(".testresult").remove(),this.value&&(b.test(this.value)?a(this).after(a("<span>").addClass("strongPass testresult").html("<span>"+c+"</span>")):a(this).after(a("<span>").addClass("testresult badPass").html("<span>"+d+"</span>")))})},a.fn.validateWithFunction=function(b){a(this).on("input",function(){if(a(this).next(".testresult").remove(),this.value)try{var c=b(this.value);c?a(this).after(a("<span>").addClass("testresult strongPass").html("<span>"+(c.constructor==String?c:"Valid")+"</span>")):a(this).after(a("<span>").addClass("testresult badPass").html("<span>Invalid</span>"))}catch(d){a(this).after(a("<span>").addClass("testresult badPass").html("<span>"+d+"</span>"))}})},a.fn.passStrength=function(b){var c={shortPass:"goodPass",badPass:"goodPass",goodPass:"strongPass",strongPass:"strongPass",baseStyle:"testresult",userid:"",messageloc:1},d=a.extend(c,b);return this.each(function(){var b=a(this);a(b).unbind().on("input",function(){var b=a.fn.teststrength(a(this).val(),a(d.userid).val(),d);1===d.messageloc?(a(this).next("."+d.baseStyle).remove(),a(this).after('<span class="'+d.baseStyle+'"><span></span></span>'),a(this).next("."+d.baseStyle).addClass(a(this).resultStyle).find("span").text(b)):(a(this).prev("."+d.baseStyle).remove(),a(this).before('<span class="'+d.baseStyle+'"><span></span></span>'),a(this).prev("."+d.baseStyle).addClass(a(this).resultStyle).find("span").text(b))}),a.fn.teststrength=function(b,c,d){var e=0;return b.length<4?(this.resultStyle=d.shortPass,a(this).shortPass):b.toLowerCase()==c.toLowerCase()?(this.resultStyle=d.badPass,a(this).samePassword):(e+=4*b.length,e+=1*(a.fn.checkRepetition(1,b).length-b.length),e+=1*(a.fn.checkRepetition(2,b).length-b.length),e+=1*(a.fn.checkRepetition(3,b).length-b.length),e+=1*(a.fn.checkRepetition(4,b).length-b.length),b.match(/(.*[0-9].*[0-9].*[0-9])/)&&(e+=5),b.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)&&(e+=5),b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(e+=10),b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)&&(e+=15),b.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&b.match(/([0-9])/)&&(e+=15),b.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&b.match(/([a-zA-Z])/)&&(e+=15),(b.match(/^\w+$/)||b.match(/^\d+$/))&&(e-=10),0>e&&(e=0),e>100&&(e=100),34>e?(this.resultStyle=d.badPass,a(this).badPass):68>e?(this.resultStyle=d.goodPass,a(this).goodPass):(this.resultStyle=d.strongPass,a(this).strongPass))}})}}(jQuery),$.fn.checkRepetition=function(a,b){for(var c="",d=0;d<b.length;d++){for(var e=!0,f=0;a>f&&f+d+a<b.length;f++)e=e&&b.charAt(f+d)==b.charAt(f+d+a);a>f&&(e=!1),e?(d+=a-1,e=!1):c+=b.charAt(d)}return c};