!function($){$.extend({jsonRPC:{version:"2.0",endPoint:null,namespace:null,setup:function(a){return this._validateConfigParams(a),this.endPoint=a.endPoint,this.namespace=a.namespace,this},withOptions:function(a,b){if(this._validateConfigParams(a),"undefined"==typeof b)throw"No callback specified";origParams={endPoint:this.endPoint,namespace:this.namespace},this.setup(a),b.call(this),this.setup(origParams)},request:function(a,b){return"undefined"==typeof b&&(b={id:1}),"undefined"==typeof b.id&&(b.id=1),this._validateRequestMethod(a),this._validateRequestParams(b.params),this._validateRequestCallbacks(b.success,b.error),this._doRequest(JSON.stringify(this._requestDataObj(a,b.params,b.id)),b),!0},batchRequest:function(a,b){if("undefined"==typeof b&&(b={}),!$.isArray(a)||0===a.length)throw"Invalid requests supplied for jsonRPC batchRequest. Must be an array object that contain at least a method attribute";var c=this;$.each(a,function(a,b){c._validateRequestMethod(b.method),c._validateRequestParams(b.params),"undefined"==typeof b.id&&(b.id=a+1)}),this._validateRequestCallbacks(b.success,b.error);for(var d,e=[],f=0;f<a.length;f++)d=a[f],e.push(this._requestDataObj(d.method,d.params,d.id));this._doRequest(JSON.stringify(e),b)},_validateConfigParams:function(a){if("undefined"==typeof a)throw"No params specified";if(a.endPoint&&"string"!=typeof a.endPoint)throw"endPoint must be a string";if(a.namespace&&"string"!=typeof a.namespace)throw"namespace must be a string"},_validateRequestMethod:function(a){if("string"!=typeof a)throw"Invalid method supplied for jsonRPC request";return!0},_validateRequestParams:function(a){if(null!==a&&"undefined"!=typeof a&&"object"!=typeof a&&!$.isArray(a))throw"Invalid params supplied for jsonRPC request. It must be empty, an object or an array.";return!0},_validateRequestCallbacks:function(a,b){if("undefined"!=typeof a&&"function"!=typeof a)throw"Invalid success callback supplied for jsonRPC request";if("undefined"!=typeof b&&"function"!=typeof b)throw"Invalid error callback supplied for jsonRPC request";return!0},_doRequest:function(a,b){var c=this;$.ajax({type:"POST",async:!1!==b.async,dataType:"json",contentType:"application/json",url:this._requestUrl(b.url),data:a,cache:!1,processData:!1,error:function(a){c._requestError.call(c,a,b.error)},success:function(a){c._requestSuccess.call(c,a,b.success,b.error)}})},_requestUrl:function(a){return a=a||this.endPoint,a+"?tm="+(new Date).getTime()},_requestDataObj:function(a,b,c){var d={jsonrpc:this.version,method:this.namespace?this.namespace+"."+a:a,id:c};return"undefined"!=typeof b&&(d.params=b),d},_requestError:function(a,b){"undefined"!=typeof b&&"function"==typeof b&&b(this._response())},_requestSuccess:function(a,b,c){var d=this._response(a);return d.error&&"function"==typeof c?(c(d),void 0):("function"==typeof b&&b(d),void 0)},_response:function(json){if("undefined"==typeof json)return{error:"Internal server error",version:"2.0"};try{if("string"==typeof json&&(json=eval("("+json+")")),$.isArray(json)&&json.length>0&&"2.0"!==json[0].jsonrpc||!$.isArray(json)&&"2.0"!==json.jsonrpc)throw"Version error";return json}catch(e){return{error:"Internal server error: "+e,version:"2.0"}}}}})}(jQuery);